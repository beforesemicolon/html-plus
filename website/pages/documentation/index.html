<variable name="page"
          value="$data.pages.documentation"></variable>
<variable name="currentGroup"
          value="page.menu.list.find((item) => path.startsWith(item.path)) ?? page"></variable>
<variable name="currentPage"
          value="currentGroup.path === path
	            ? currentGroup
	            : currentGroup.list.find((item) => item.path === path)"></variable>
<variable name="title"
          value="`${page.title} ${currentPage === page ? '' : `: ${currentPage.title}`}`"></variable>

<include partial="layout" data="{...page, title}">
	<link rel="stylesheet" href="documentation.scss" inject-id="style">
	<link rel="stylesheet" href="./../../node_modules/highlight.js/styles/github-dark-dimmed.css" inject-id="style">

	<main class="documentation wrapper">
		<aside>
			<input id="menu-check" type="checkbox" style="display: none">
			<header>
				<label class="menu-toggle" for="menu-check" aria-label="mobile menu toggle"></label>
				<include partial="search-field" data="{
					props: {placeholder: 'Search...', style: 'display: none;'}
				}"></include>
			</header>
			<section class="doc-menu-section">
				<h2>{page.menu.title}</h2>
				<ul role="menu" aria-label="Documentation Menu" class="doc-menu">
					<li #repeat="page.menu.list" #attr="class, current, path === $item.path">
						<variable name="hasSubmenu"
						          value="Boolean($item.list?.length)"></variable>
						<variable name="expanded"
						          value="hasSubmenu && path.startsWith($item.path)"></variable>

						<a href="{$item.path}"
						   aria-haspopup="{hasSubmenu}"
						   aria-expanded="{expanded}"
						   role="menuitem">{$item.title}</a>

						<span #if="hasSubmenu" class="expand-indicator {expanded ? 'expanded' : ''}"></span>

						<ul #if="hasSubmenu" #attr="class, expanded, expanded">
							<li #repeat="$item.list" #attr="class, current, path === $item.path">
								<a href="{$item.path}"><ignore value="$item.title" escape></ignore></a>
							</li>
						</ul>
					</li>
				</ul>
			</section>
		</aside>
		<article #if="currentPage" id="documentation">
			<h2><ignore value="currentPage === page ? page.menu.title : currentPage.title" escape></ignore></h2>
			<include partial="{currentPage.partial}"></include>
		</article>
	</main>

	<script src="./documentation.ts" inject-id="script"></script>
</include>
