<variable name="page"
          value="$data.pages.documentation"></variable>
<variable name="currentGroup"
          value="page.menu.list.find((item) => $data.path.startsWith(item.path)) ?? page"></variable>
<variable name="currentPage"
          value="currentGroup.path === $data.path
	            ? currentGroup
	            : currentGroup.list.find((item) => item.path === $data.path)"></variable>

<include partial="layout" data="{...page, title: `${page.title}: ${currentPage.title}`}">
	<link rel="stylesheet" href="documentation.scss" inject-id="style">
	<main class="documentation wrapper">
		<aside>
			<include partial="search-field" data="{placeholder: 'Search...'}"></include>
			<section>
				<h2>{page.menu.title}</h2>
				<ul role="menu" aria-label="Documentation Menu">
					<li #repeat="page.menu.list" #attr="class, current, $data.path === $item.path">
						<variable name="hasSubmenu"
						          value="Boolean($item.list?.length)"></variable>
						<variable name="expanded"
						          value="hasSubmenu && $data.path.startsWith($item.path)"></variable>

						<a href="{$item.path}"
						   aria-haspopup="{hasSubmenu}"
						   aria-expanded="{expanded}"
						   role="menuitem">{$item.title}</a>

						<span #if="hasSubmenu" class="expand-indicator {expanded ? 'expanded' : ''}"></span>

						<ul #if="hasSubmenu" #attr="class, expanded, expanded">
							<li #repeat="$item.list" #attr="class, current, $data.path === $item.path">
								<a href="{$item.path}"><ignore value="$item.title" escape></ignore></a>
							</li>
						</ul>
					</li>
				</ul>
			</section>
		</aside>
		<article #if="currentPage" id="documentation">
			<h2><ignore value="currentPage.title" escape></ignore></h2>
			<include partial="{currentPage.partial}"></include>
		</article>
	</main>

</include>