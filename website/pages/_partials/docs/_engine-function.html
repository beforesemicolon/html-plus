<include partial="api-table-details" data="{
	name: 'engine',
	details: {
		name: 'engine',
		type: 'async function',
		arguments: 'express app, pages directory, options',
		description: 'A function that will setup the express engine and setup the routing of your application.',
	}
}"></include>
<h3>Asynchronous function</h3>
<p>The <strong>engine</strong> function is ASYNCHRONOUS which means that you can await on it before you start the server.</p>
<code-snippet language="js">
const {engine} = require('@beforesemicolon/html-plus');

const app = express();

(async () => {
	// setup all middlewares and any route overrides before the engine
	await engine(app, path.resolve(__dirname, './pages'), {
		staticData: {
			site: {
				version: "2.4.1",
				license: "MIT"
			}
		}
	});

	app.listen(3000);
})();
</code-snippet>
<p>If you await on the engine and have some <a href="/documentation/routes/route-pages">dynamic routes</a>
you may need to set them up before otherwise any matching static route will override them. Prefer the engine
call as the last thing before you call the <strong>listen</strong> method for the server.</p>
<p>If you are not awaiting the engine, you can just set the routes after. The effect is the same but not
awaiting on the engine may throw an error if you get to the page before the engine is done processing your
pages directory.</p>
<h3>Arguments</h3>
<include partial="api-description-list" data="{
	descriptions: [
		{
			concept: 'express app',
			type: 'type: object, required',
			description: 'An <a href=\'https://expressjs.com/en/4x/api.html#app\'>express app</a>'
		},
		{
			concept: 'pages directory',
			type: 'type: string, required',
			description: 'A valid absolute path to the directory where all HTML files will be placed.'
		},
		{
			concept: 'options',
			type: 'type: object, optional',
			description: 'Object with different options to be consumed by the engine.'
		},
	]
}"></include>
<h3>Options</h3>
<include partial="api-description-list" data="{
	descriptions: [
		{
			concept: 'staticData',
			type: 'type: object',
			description: 'An object with whatever data you want to be available on all templates.'
		},
		{
			concept: 'customTags',
			type: 'type: array',
			description: 'An array of function or class based custom tags.'
		},
		{
			concept: 'customAttributes',
			type: 'type: array',
			description: 'An array of <a href=\'/documentation/api-reference/attribute-class\'>Attributes</a> based custom attributes.'
		},
		{
			concept: 'env',
			type: 'type: string',
			description: 'A string of value \'development\' or \'production\' that will signal how engine should handle the pages.'
		},
		{
			concept: 'onPageRequest',
			type: 'type: function',
			description: 'A callback function that will be called on every page request with a <a href=\'https://expressjs.com/en/4x/api.html#req\'>express request</a> that must return an object representing the <a href=\'/documentation/data/local-context-data\'>context data</a> to be passed to the template to be rendered on that page request.'
		},
	]
}"></include>
<h3>Return</h3>
<p>The engine returns undefined.</p>
<h3>Usage Examples</h3>
<code-snippet language="js">
engine(app, path.resolve(__dirname, './pages'), {
	staticData: {
		site: {
			version: "2.4.1",
			license: "MIT"
		}
	}
});
</code-snippet>
<code-snippet language="js">
engine(app, path.resolve(__dirname, './pages'), {
	onPageRequest: (req) => {
		return {
			path: req.path,
			params: req.params
		}
	}
});
</code-snippet>
<include partial="documentation-menu" data="{currentPage}"></include>
